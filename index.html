<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© | Ø§Ù„Ø£Ø³ØªØ§Ø° Ù…Ø­Ù…Ø¯ Ø·Ù‡</title>
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #a855f7;
            --bg-dark: #0f172a;
            --editor-bg: #1e1e2e;
        }

        body, html { 
            margin: 0; padding: 0; height: 100%; 
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: radial-gradient(circle at top right, #1e293b, #0f172a);
            color: white; overflow: hidden;
        }

        #desktop { height: 100vh; position: relative; }

        .main-icon {
            width: 100px; text-align: center; cursor: pointer;
            transition: 0.3s; margin: 30px;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px; border-radius: 20px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);
        }
        .main-icon:hover { transform: scale(1.1); background: rgba(255, 255, 255, 0.2); }

        #window {
            width: 95%; height: 88vh;
            background: rgba(30, 41, 59, 0.98);
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 16px; display: none; flex-direction: column;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .title-bar {
            background: rgba(255,255,255,0.05); padding: 15px 20px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .controls {
            padding: 10px 20px; background: rgba(0,0,0,0.3);
            display: flex; gap: 15px; align-items: center;
        }

        .btn {
            padding: 10px 18px; border: none; border-radius: 8px;
            cursor: pointer; font-weight: 600; transition: 0.3s;
            display: flex; align-items: center; gap: 8px; color: white;
        }
        .btn-check { background: var(--primary); }
        .btn-wa { background: #25D366; }
        .btn:hover { transform: translateY(-2px); opacity: 0.9; }

        .work-area { display: flex; flex: 1; padding: 15px; gap: 15px; }

        .editor-container { flex: 1; display: flex; flex-direction: column; }
        textarea {
            flex: 1; background: var(--editor-bg); color: #f8f8f2;
            font-family: 'Consolas', monospace; padding: 15px;
            border-radius: 12px; border: 1px solid #444; resize: none;
            outline: none; direction: ltr; text-align: left; font-size: 15px;
        }

        .preview-container { flex: 1; background: white; border-radius: 12px; overflow: hidden; }
        iframe { width: 100%; height: 100%; border: none; }

        .close-btn { color: #ff5f56; cursor: pointer; font-size: 20px; font-weight: bold; }
        #trainee-name-display { color: #a855f7; font-weight: bold; margin-right: 10px; }
    </style>
</head>
<body oncontextmenu="return false;">

<div id="desktop">
    <div class="main-icon" onclick="startSession()">
        <div style="font-size: 50px;">ğŸ’»</div>
        <div style="margin-top: 10px; font-weight: bold;">Ù…Ø­Ø±Ø± Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</div>
    </div>

    <div id="window">
        <div class="title-bar">
            <div>
                <span style="font-weight:bold;">Ø¨ÙŠØ¦Ø© Ø§Ù„Ù…ØªØ¯Ø±Ø¨: </span>
                <span id="trainee-name-display"></span>
            </div>
            <span class="close-btn" onclick="closeWindow()">âœ•</span>
        </div>
        
        <div class="controls">
            <button class="btn btn-check" onclick="validateCode()">ğŸ” ÙØ­Øµ Ø£Ø³Ø·Ø± Ø§Ù„Ø®Ø·Ø£</button>
            <button class="btn btn-wa" onclick="sendWhatsApp()">ğŸ“± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù„Ù…Ø¹Ù„Ù…</button>
        </div>

        <div class="work-area">
            <div class="editor-container">
                <textarea id="codeEditor" oninput="updatePreview()" spellcheck="false" placeholder="Ø§ÙƒØªØ¨ ÙƒÙˆØ¯ HTML Ù‡Ù†Ø§..."></textarea>
            </div>
            <div class="preview-container">
                <iframe id="preview"></iframe>
            </div>
        </div>
    </div>
</div>

<script>
    const MY_PHONE = "249901946410";
    let traineeName = "";

    function startSession() {
        // Ø·Ù„Ø¨ Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¯Ø±Ø¨
        traineeName = prompt("Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù…ØªØ¯Ø±Ø¨ØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©:");
        
        if (traineeName && traineeName.trim() !== "") {
            document.getElementById('trainee-name-display').innerText = traineeName;
            openWindow();
        } else {
            alert("ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ù„ÙØªØ­ Ø§Ù„Ù…Ø­Ø±Ø±!");
        }
    }

    function openWindow() {
        document.getElementById('window').style.display = 'flex';
        if(!document.getElementById('codeEditor').value) {
            document.getElementById('codeEditor').value = `\n<html>\n  <body>\n    <h1>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ ${traineeName}</h1>\n    <p>Ø§Ø¨Ø¯Ø£ Ø¨ÙƒØªØ§Ø¨Ø© ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø£ÙˆÙ„ Ù‡Ù†Ø§...</p>\n  </body>\n</html>`;
        }
        updatePreview();
    }

    function closeWindow() {
        if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø­Ø±Ø±ØŸ ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø£ÙˆÙ„Ø§Ù‹.")) {
            document.getElementById('window').style.display = 'none';
        }
    }

    function updatePreview() {
        const code = document.getElementById('codeEditor').value;
        const previewFrame = document.getElementById('preview').contentWindow.document;
        previewFrame.open();
        previewFrame.write(code);
        previewFrame.close();
    }

    function validateCode() {
        const code = document.getElementById('codeEditor').value;
        const lines = code.split('\n');
        let errorMessages = [];
        const tagsToWatch = ['html', 'body', 'h1', 'p', 'b', 'div', 'head', 'title'];

        lines.forEach((line, index) => {
            tagsToWatch.forEach(tag => {
                const openTag = `<${tag}>`;
                const closeTag = `</${tag}>`;
                if (line.includes(openTag)) {
                    const totalOpen = (code.match(new RegExp("<" + tag + ">", "g")) || []).length;
                    const totalClose = (code.match(new RegExp("</" + tag + ">", "g")) || []).length;
                    if (totalOpen > totalClose) {
                        errorMessages.push(`âš ï¸ Ø§Ù„Ø³Ø·Ø± ${index + 1}: ÙˆØ³Ù… <${tag}> Ù…ÙØªÙˆØ­ ÙˆÙ„Ù… ÙŠØªÙ… Ø¥ØºÙ„Ø§Ù‚Ù‡.`);
                    }
                }
            });
        });

        if (errorMessages.length > 0) {
            alert("ØªÙ†Ø¨ÙŠÙ‡ Ù„Ù„Ù…ØªØ¯Ø±Ø¨ " + traineeName + ":\n\n" + [...new Set(errorMessages)].join("\n"));
        } else {
            alert("Ù…Ù…ØªØ§Ø² ÙŠØ§ " + traineeName + "! Ø§Ù„ÙƒÙˆØ¯ Ø³Ù„ÙŠÙ….");
        }
    }

    function sendWhatsApp() {
        const code = document.getElementById('codeEditor').value;
        const fullMsg = `Ø§Ù„Ø§Ø³Ù…: ${traineeName}\n\nØ§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ù†Ø¬Ø²:\n${code}`;
        const encodedMsg = encodeURIComponent(fullMsg);
        window.open(`https://wa.me/${MY_PHONE}?text=${encodedMsg}`, '_blank');
    }

    // Ù…Ù†Ø¹ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª
    document.onkeydown = function(e) {
        if (e.keyCode == 123 || (e.ctrlKey && (e.keyCode == 85 || e.keyCode == 67))) return false;
    };
</script>
</body>
</html>
